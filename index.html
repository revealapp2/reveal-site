

<!-- Chatbot Structure -->
<div id="chatbot-icon" class="chatbot-icon">
    <i class="fas fa-comment-dots"></i>
</div>

<div id="chatbot-window" class="chatbot-window">
    <div class="chatbot-header">
        <span data-translate="chatbotHeader">Chat Assistant</span>
        <button id="chatbot-close" class="chatbot-close">&times;</button>
    </div>
    <div id="chatbot-messages" class="chatbot-messages">
        <!-- Messages will be added here -->
    </div>
    <div id="chatbot-buttons" class="chatbot-buttons">
        <!-- Buttons will be added here -->
    </div>
</div>

    <script src="translations.js"></script>
    <script>
        // Main site script content...
        // ... (existing script content) ...

        // Ensure updateChatbotLanguage is called within setLanguage
        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('language', lang);
            document.documentElement.lang = lang; // Update the lang attribute of the html tag

            // Update language selector value
            const selector = document.querySelector('#language-selector select');
            if (selector) {
                selector.value = lang;
            }

            // Update all elements with data-translate attribute
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[lang] && translations[lang][key]) {
                    // Use innerHTML to allow for HTML tags like <strong> in translations
                    element.innerHTML = translations[lang][key];
                }
            });
            
            // Update placeholders
            document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (translations[lang] && translations[lang][key]) {
                    element.placeholder = translations[lang][key];
                }
            });

            // *** ADDED: Update chatbot language ***
            if (typeof updateChatbotLanguage === 'function') {
                updateChatbotLanguage(lang);
            }
            // *** END ADDED ***
        }

        // Optimize QR Code generation - remove setTimeout
        function generateQRCode(paymentMethod) {
            closePaymentMethodDialog();
            const paymentDialog = document.getElementById('payment-dialog');
            paymentDialog.style.display = 'flex';
            document.getElementById('loading').style.display = 'block'; // Show loading briefly
            document.getElementById('qr-code').style.display = 'none';
            document.getElementById('payment-details').style.display = 'none';

            // Update loading text language
            document.getElementById('loading').innerText = getTranslatedString('loadingText');

            // *** RE-ADD setTimeout ***
            setTimeout(() => {
                const qrCode = document.getElementById('qr-code');
                const amountEl = document.getElementById("amount");
                const walletAddress = document.getElementById("wallet-address");
                const platformTitle = document.getElementById("platform-title");
                const paymentNetworkEl = document.getElementById("payment-network");

                qrCode.src = `${paymentMethod}-qr.png`;
                
                const price = selectedPokerApp === "clubgg" ? "$4000 USD" : "$1500 USD";
                amountEl.textContent = getTranslatedString("amountTextBase", { PRICE: price });

                let address = "";
                let networkName = "";
                if (paymentMethod === "btc") {
                    address = "bc1qd0l9j7llwxj875e43u8rycnjwvswk6lm4m3p5g";
                    networkName = getTranslatedString("networkBTC");
                } else if (paymentMethod === "eth") {
                    address = "0x87933Cf11611885C0F445C5a64359A659302a759";
                    networkName = getTranslatedString("networkETH");
                } else if (paymentMethod === "usdt") {
                    address = "TFXqX55uXNfdhGgX64m6nmJ5o4bjf6Jh6f";
                    networkName = getTranslatedString("networkUSDT");
                }
                walletAddress.value = address;
                platformTitle.textContent = getTranslatedString("paymentDialogTitleBase", { METHOD: paymentMethod.toUpperCase(), PLATFORM: selectedPlatform.toUpperCase() });
                paymentNetworkEl.textContent = getTranslatedString("networkInfo", { NETWORK: networkName }); // Display network info

                document.getElementById('loading').style.display = 'none';
                document.getElementById('qr-code').style.display = 'block';
                document.getElementById('payment-details').style.display = 'block';
            }, 5000); // 5-second delay
            // *** END RE-ADD setTimeout ***
        }
        // ... (rest of existing script content) ...

    </script>
    <script src="chatbot.js"></script> <!-- Added chatbot script -->
</body>
</html>
